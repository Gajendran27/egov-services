{
	"info": {
		"name": "eGov-Works-RegularAE_functionalTest",
		"_postman_id": "4ce5c79c-a566-d78c-6fb8-664cf05c4a43",
		"description": "",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Login as Clerk",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "cd1fcd17-644d-4b37-a625-8aa58469e23f",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
							"",
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"tests[\"Tenant ID is default\"] = jsonData.UserRequest.roles[0].tenantId;",
							"",
							"postman.setNextRequest(\"WorksMdmsData\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-www-form-urlencoded"
					},
					{
						"key": "Authorization",
						"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "username",
							"value": "clerk",
							"type": "text"
						},
						{
							"key": "password",
							"value": "12345678",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "read",
							"type": "text"
						},
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{url}}/user/oauth/token",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"oauth",
						"token"
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "WorksMdmsData",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "35106fb0-a311-4d11-a980-9b270c668b77",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"var uom = jsonData.MdmsRes[\"common-masters\"].Uom;",
							"var dep = jsonData.MdmsRes[\"common-masters\"].Department;",
							"var typeOfWork = jsonData.MdmsRes.works.TypeOfWork;",
							"var scheduleCategory = jsonData.MdmsRes.works.ScheduleCategory;",
							"var referenceType = jsonData.MdmsRes.works.ReferenceType;",
							"var budgetGroup = jsonData.MdmsRes.works.BudgetGroup;",
							"var modeOfAllotment = jsonData.MdmsRes.works.ModeOfAllotment;",
							"var natureOfWork = jsonData.MdmsRes.works.NatureOfWork;",
							"",
							"var uomCode = uom[Math.floor(Math.random() * uom.length)];",
							"var depCode = dep[Math.floor(Math.random() * dep.length)];",
							"var typeOfWorkCode = typeOfWork[Math.floor(Math.random() * typeOfWork.length)];",
							"var scheduleCategoryCode = scheduleCategory[Math.floor(Math.random() * scheduleCategory.length)];",
							"var referenceTypeCode = referenceType[Math.floor(Math.random() * referenceType.length)];",
							"var budgetGroupCode = budgetGroup[Math.floor(Math.random() * budgetGroup.length)];",
							"var modeOfAllotmentCode = modeOfAllotment[Math.floor(Math.random() * modeOfAllotment.length)];",
							"var natureOfWorkCode = natureOfWork[Math.floor(Math.random() * natureOfWork.length)];",
							"",
							"var tW = \"\";",
							"for(var j=0; j<typeOfWork.length; j++){",
							"    if(typeOfWork[j].parent == null){",
							"        pm.environment.set(\"typeOfWork\", typeOfWork[j].code);",
							"        tW = typeOfWork[j].code;",
							"        break;",
							"    }",
							"}",
							"console.log(tW);",
							"for (var i=0; i<typeOfWork.length; i++){",
							"    if(typeOfWork[i].parent !== null && typeOfWork[i].parent === tW){",
							"    pm.environment.set(\"subTypeOfWork\", typeOfWork[i].code);",
							"    break;",
							"    }",
							"}",
							"",
							"pm.environment.set(\"uom\", uomCode.code);",
							"pm.environment.set(\"dep\", depCode.code);",
							"pm.environment.set(\"scheduleCategory\", scheduleCategoryCode.code);",
							"pm.environment.set(\"referenceType\", referenceTypeCode.code);",
							"pm.environment.set(\"budgetGroup\", budgetGroupCode.name);",
							"pm.environment.set(\"modeOfAllotment\", modeOfAllotmentCode.code);",
							"pm.environment.set(\"natureOfWork\", natureOfWorkCode.name);",
							"",
							"postman.setNextRequest(\"Create AE\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{  \n  \"RequestInfo\":{  \n     \"apiId\":\"works-services\",\n      \"ver\":null,\n      \"ts\":null,\n      \"action\":null,\n      \"did\":null,\n      \"key\":null,\n      \"msgId\":\"search with from and to values\",\n      \"authToken\":\"{{access_token}}\",\n      \"tenantId\": \"{{tenantId}}\"\n   },\n   \"MdmsCriteria\":{  \n     \"tenantId\":\"{{tenantId}}\",\n      \"moduleDetails\":[  \n        {  \n           \"moduleName\":\"works\",\n            \"masterDetails\":[  \n              {  \n                 \"name\":\"ScheduleCategory\"\n               },\n                {  \n                 \"name\":\"TypeOfWork\"\n               },\n               {\n               \"name\": \"Overhead\"\n               },\n               {\n                 \"name\": \"Remarks\"\n               },\n               {\n                 \"name\": \"ReferenceType\"\n               },\n               {\n                 \"name\": \"BudgetGroup\"\n               },\n               {\n                 \"name\": \"NatureOfWork\"\n               },\n               {\n                 \"name\": \"ModeOfAllotment\"\n               },\n               {\n                 \"name\": \"ContractorClass\"\n               },\n               {\n                 \"name\": \"WorksStatus\"\n               }\n            ]\n         },\n         {  \n           \"moduleName\":\"common-masters\",\n            \"masterDetails\":[  \n              {  \n                 \"name\":\"Department\"\n               },\n               {\n                  \"name\":\"Uom\"\n               }\n            ]\n         }\n      ]\n   }\n}"
				},
				"url": {
					"raw": "{{url}}/egov-mdms-service/v1/_search",
					"host": [
						"{{url}}"
					],
					"path": [
						"egov-mdms-service",
						"v1",
						"_search"
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Create AE",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "9e50aeaf-1e9c-41a4-843d-05971b6b6fe2",
						"type": "text/javascript",
						"exec": [
							"var num1 = Math.floor((Math.random() * 10000) + 1);",
							"var name2 = Math.floor(Math.random() * (999999 - 100000 + 1)) + 100000;",
							"var today = new Date();",
							"var epoch = Math.round(today.getTime()/1000);",
							"var year = today.getFullYear();",
							"",
							"pm.environment.set(\"referenceNumber\", \"RefNum\"+num1);",
							"pm.environment.set(\"epochDate\", epoch);"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "b3a04e06-2c5b-4615-ac33-0c9679017eb7",
						"type": "text/javascript",
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"var jsonData = JSON.parse(responseBody);",
							"pm.environment.set(\"AE_id\", jsonData.abstractEstimates[0].id);",
							"pm.environment.set(\"AEdetails_id\", jsonData.abstractEstimates[0].abstractEstimateDetails[0].id);",
							"pm.environment.set(\"AE_workflow\", jsonData.abstractEstimates[0].abstractEstimateNumber);",
							"pm.globals.set(\"AE_workflow\", jsonData.abstractEstimates[0].abstractEstimateNumber);",
							"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status.code);",
							"pm.environment.set(\"stateId\", jsonData.abstractEstimates[0].stateId);",
							"",
							"postman.setNextRequest(\"Search AE\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"create\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n  },\n  \"abstractEstimates\": [\n    {\n      \"tenantId\": \"{{tenantId}}\",\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\": \"{{referenceType}}\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"description\": \"Hospital Construction Project Estimation for the proposed work\",\n      \"budgetGroup\": {\n        \"name\": \"{{budgetGroup}}\"\n      },\n      \"department\": {\n        \"code\": \"{{dep}}\"\n      },\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"{{modeOfAllotment}}\"\n      },\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUPBSUP\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"{{typeOfWork}}\"\n      },\n      \"subTypeOfWork\": {\n        \"code\": \"{{subTypeOfWork}}\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"{{natureOfWork}}\"\n      },\n      \"ward\": {\n        \"code\": 172\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"workOrderCreated\": false,\n      \"billsCreated\": false,\n      \"spillOverFlag\": false,\n      \"detailedEstimateCreated\": false,\n      \"implementationPeriod\": 1,\n      \"fundAvailable\": true,\n      \"pmcRequired\": false,\n      \"workProposedAsPerDP\": true,\n      \"dpRemarks\": \"DP Remarks\",\n      \"landAssetRequired\": false,\n      \"noOfLands\": null,\n      \"otherAssetSpecificationRemarks\": \"Other Remarks\",\n      \"abstractEstimateDetails\": [\n        {\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hospital Building work\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Create\",\n        \"assignee\": 459\n      }\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_create",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_create"
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Search AE",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "59240b63-3c9f-4099-90a7-519398c498da",
						"type": "text/javascript",
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"postman.setNextRequest(\"Logout as Clerk\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"requestInfo\": {\n    \"action\": \"search\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&ids={{AE_id}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_search"
					],
					"query": [
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"equals": true
						},
						{
							"key": "ids",
							"value": "{{AE_id}}",
							"equals": true
						}
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Logout as Clerk",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "b3181149-f32b-436b-810c-101108f83715",
						"type": "text/javascript",
						"exec": [
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Login as HOD\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/user/_logout?access_token={{access_token}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"_logout"
					],
					"query": [
						{
							"key": "access_token",
							"value": "{{access_token}}",
							"equals": true
						}
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Login as HOD",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "07566acc-5e15-4739-b460-9b8df1fe9592",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
							"",
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Update AE Checked\");",
							"",
							""
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-www-form-urlencoded"
					},
					{
						"key": "Authorization",
						"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "username",
							"value": "HOD",
							"type": "text"
						},
						{
							"key": "password",
							"value": "12345678",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "read",
							"type": "text"
						},
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{url}}/user/oauth/token",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"oauth",
						"token"
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Update AE Checked",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "768a0922-99b0-4c95-880a-dda1adb3d9af",
						"type": "text/javascript",
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"var jsonData = JSON.parse(responseBody);",
							"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status.code);",
							"postman.setNextRequest(\"Search AE Checked\");"
						]
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "1403f27e-55f6-4481-93ba-c4ba2768aeed",
						"type": "text/javascript",
						"exec": [
							""
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"userInfo\": {\n     \"tenantId\": \"{{tenantId}}\"\n    }\n  },\n  \"abstractEstimates\": [\n    {\n      \"id\": \"{{AE_id}}\",\n      \"tenantId\": \"{{tenantId}}\",\n      \"abstractEstimateNumber\": \"{{AE_workflow}}\",\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\":\"{{referenceType}}\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Abstract Estimate for Project Cost Estimation\",\n      \"budgetGroup\": {\n        \"name\": \"{{budgetGroup}}\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUP\"\n      },\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"department\": {\n        \"code\": \"{{dep}}\"\n      },\n      \"status\": {\n      \t\"tenantId\": \"{{tenantId}}\",\n      \t\"code\": \"{{status}}\"\n      \t},\n      \"stateId\": \"{{stateId}}\",\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"{{modeOfAllotment}}\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"{{typeOfWork}}\"\n      },\n    \"subTypeOfWork\": {\n        \"code\": \"{{subTypeOfWork}}\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"{{natureOfWork}}\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"workOrderCreated\": false,\n      \"billsCreated\": false,\n      \"spillOverFlag\": false,\n      \"detailedEstimateCreated\": false,\n      \"workProposedAsPerDP\": true,\n      \"dpRemarks\": \"Estimation Approved by HOD\",\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"abstractEstimateDetails\": [\n        {\n          \"id\": \"{{AEdetails_id}}\",\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hospital\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n      \t\"tenantId\": \"{{tenantId}}\",\n        \"action\": \"Submit\",\n        \"assignee\": 509\n      }\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_update",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_update"
					]
				},
				"description": "@JE login"
			},
			"response": []
		},
		{
			"name": "Search AE Checked",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "fee704d7-0d7a-4122-b78a-e40a031b2eab",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"",
							"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status.code);",
							"",
							"pm.test(\"AE status is Checked\", function () {",
							"    pm.expect(\"CHECKED\").to.include(jsonData.abstractEstimates[0].status.code);",
							"});",
							"",
							"postman.setNextRequest(\"Logout as HOD\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"requestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&abstractEstimateNumbers={{AE_workflow}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_search"
					],
					"query": [
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"equals": true
						},
						{
							"key": "abstractEstimateNumbers",
							"value": "{{AE_workflow}}",
							"equals": true
						}
					]
				},
				"description": "@JE login"
			},
			"response": []
		},
		{
			"name": "Logout as HOD",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "d72a57c7-1e4b-4d6d-9168-ea1114f50096",
						"type": "text/javascript",
						"exec": [
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Login as ACC\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/user/_logout?access_token={{access_token}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"_logout"
					],
					"query": [
						{
							"key": "access_token",
							"value": "{{access_token}}",
							"equals": true
						}
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Login as ACC",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "7cd3f470-a22f-494e-b6b6-ee380ffee4c5",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
							"",
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Update AE (FS)\");",
							"",
							""
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-www-form-urlencoded"
					},
					{
						"key": "Authorization",
						"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "username",
							"value": "10001",
							"type": "text"
						},
						{
							"key": "password",
							"value": "12345678",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "read",
							"type": "text"
						},
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{url}}/user/oauth/token",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"oauth",
						"token"
					]
				},
				"description": null
			},
			"response": []
		},
		{
			"name": "Update AE (FS)",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "09e337d1-a5de-4ca5-b12b-d6d51b806757",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"",
							"// pm.globals.set(\"projectCode\", jsonData.abstractEstimates[0].abstractEstimateDetails[0].projectCode.code);",
							"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status.code);",
							"postman.setNextRequest(\"Search AE FS\");"
						]
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "276a0fcd-5a6f-4604-a3f6-9d3b83c136e0",
						"type": "text/javascript",
						"exec": [
							"var num1 = Math.floor((Math.random() * 10000) + 1);",
							"var today = new Date();",
							"var epoch = Math.round(today.getTime()/1000);",
							"var year = today.getFullYear();",
							"pm.environment.set(\"financialSanctionNumber\", \"FS-ENG-NS-\"+year+\"-\"+num1);"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"userInfo\": {\n     \"tenantId\": \"{{tenantId}}\"\n    }\n  },\n  \"abstractEstimates\": [\n    {\n      \"id\": \"{{AE_id}}\",\n      \"tenantId\": \"{{tenantId}}\",\n      \"abstractEstimateNumber\": \"{{AE_workflow}}\",\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\":\"{{referenceType}}\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Abstract Estimate for Project Cost Estimation\",\n      \"budgetGroup\": {\n        \"name\": \"4122001-CWIP-Office Buildings\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUP\"\n      },\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"department\": {\n        \"code\": \"{{dep}}\"\n      },\n      \"status\": {\n      \t\"code\": \"{{status}}\"\n      \t},\n      \"stateId\": \"{{stateId}}\",\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"{{modeOfAllotment}}\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"{{typeOfWork}}\"\n      },\n    \"subTypeOfWork\": {\n        \"code\": \"{{subTypeOfWork}}\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"{{natureOfWork}}\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"workOrderCreated\": \"false\",\n      \"billsCreated\": \"false\",\n      \"spillOverFlag\": \"false\",\n      \"detailedEstimateCreated\": \"false\",\n      \"workProposedAsPerDP\": true,\n      \"dpRemarks\": \"Estimation Approved by HOD\",\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"financialSanctionNumber\": \"{{financialSanctionNumber}}\",\n      \"financialSanctionDate\": \"{{epochDate}}\",\n      \"financialSanctionBy\": {\n        \"userName\": \"10002\"\n      },\n      \"abstractEstimateDetails\": [\n        {\n          \"id\": \"{{AEdetails_id}}\",\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hospital 1\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Submit\",\n        \"assignee\": 510\n      }\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_update",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_update"
					]
				},
				"description": "@CE login"
			},
			"response": []
		},
		{
			"name": "Search AE FS",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "e6dce7d1-4bc8-4ae9-92f9-3182780cd9e4",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"",
							"pm.test(\"AE status is Financial Sanctioned\", function () {",
							"    pm.expect(\"FINANCIAL_SANCTIONED\").to.include(jsonData.abstractEstimates[0].status.code);",
							"    pm.environment.set(\"status\", jsonData.abstractEstimates[0].status.code);",
							"});",
							"",
							"pm.environment.set(\"projectCode\", jsonData.abstractEstimates[0].abstractEstimateDetails[0].projectCode.code);",
							"postman.setNextRequest(\"Logout as ACC\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"requestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&ids={{AE_id}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_search"
					],
					"query": [
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"equals": true
						},
						{
							"key": "ids",
							"value": "{{AE_id}}",
							"equals": true
						}
					]
				},
				"description": "@CE login"
			},
			"response": []
		},
		{
			"name": "Logout as CE",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "63dfd7de-b53f-454f-b57c-ce323b0d6982",
						"type": "text/javascript",
						"exec": [
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Login as CE\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/user/_logout?access_token={{access_token}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"_logout"
					],
					"query": [
						{
							"key": "access_token",
							"value": "{{access_token}}",
							"equals": true
						}
					]
				},
				"description": null
			},
			"response": []
		},
		{
			"name": "Login as CE",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "00f39c96-c7a2-49a8-8317-d2e747c67675",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
							"",
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Update AE (AS)\");",
							"",
							""
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-www-form-urlencoded"
					},
					{
						"key": "Authorization",
						"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "username",
							"value": "10002",
							"type": "text"
						},
						{
							"key": "password",
							"value": "12345678",
							"type": "text"
						},
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "scope",
							"value": "read",
							"type": "text"
						},
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"type": "text"
						}
					]
				},
				"url": {
					"raw": "{{url}}/user/oauth/token",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"oauth",
						"token"
					]
				},
				"description": ""
			},
			"response": []
		},
		{
			"name": "Update AE (AS)",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "0907ba01-9a41-44bf-a312-20cd5f5e8bb7",
						"type": "text/javascript",
						"exec": [
							"var num1 = Math.floor((Math.random() * 10000) + 1);",
							"var today = new Date();",
							"var epoch = Math.round(today.getTime()/1000);",
							"var year = today.getFullYear();",
							"pm.environment.set(\"adminSanctionNumber\", \"ADN-\"+year+\"-\"+num1);",
							"pm.environment.set(\"councilResolutionNumber\", \"CRN-\"+year+\"-\"+num1);"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "118a84f0-3292-44c3-a096-9682ece95883",
						"type": "text/javascript",
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"var jsonData = JSON.parse(responseBody);",
							"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status.code);",
							"postman.setNextRequest(\"Search AE AS\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"userInfo\": {\n     \"tenantId\": \"{{tenantId}}\"\n    }\n  },\n  \"abstractEstimates\": [\n    {\n      \"id\": \"{{AE_id}}\",\n      \"tenantId\": \"{{tenantId}}\",\n      \"abstractEstimateNumber\": \"{{AE_workflow}}\",\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\":\"{{referenceType}}\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Abstract Estimate for Project Cost Estimation\",\n      \"budgetGroup\": {\n        \"name\": \"{{budgetGroup}}\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUP\"\n      },\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"department\": {\n        \"code\": \"{{dep}}\"\n      },\n      \"status\": {\n      \t\"code\": \"{{status}}\"\n      },\n      \"stateId\": \"{{stateId}}\",\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"{{modeOfAllotment}}\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"{{typeOfWork}}\"\n      },\n    \"subTypeOfWork\": {\n        \"code\": \"{{subTypeOfWork}}\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"{{natureOfWork}}\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"councilResolutionNumber\": \"{{councilResolutionNumber}}\",\n      \"councilResolutionDate\": \"{{epochDate}}\",\n      \"workOrderCreated\": false,\n      \"billsCreated\": false,\n      \"spillOverFlag\": false,\n      \"detailedEstimateCreated\": false,\n      \"workProposedAsPerDP\": true,\n      \"dpRemarks\": \"Estimation Approved by HOD\",\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"adminSanctionNumber\": \"{{adminSanctionNumber}}\",\n      \"adminSanctionDate\": \"{{epochDate}}\",\n      \"adminSanctionBy\": {\n        \"userName\": \"10002\"\n      },\n      \"abstractEstimateDetails\": [\n        {\n          \"id\": \"{{AEdetails_id}}\",\n          \"projectCode\": {\n            \"code\": \"{{projectCode}}\"\n          },\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hspital 2\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Approve\"\n      }\n    }\n  ]\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_update",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_update"
					]
				},
				"description": "@CE login"
			},
			"response": []
		},
		{
			"name": "Search AE AS",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "6aeb2115-d5c8-407b-ac35-54e7ae9e8569",
						"type": "text/javascript",
						"exec": [
							"var jsonData = JSON.parse(responseBody);",
							"",
							"pm.globals.set(\"AEnumber\", jsonData.abstractEstimates[0].abstractEstimateNumber);",
							"pm.globals.set(\"AEprojectCode\", jsonData.abstractEstimates[0].abstractEstimateDetails[0].projectCode.code);",
							"",
							"postman.setNextRequest(\"Logout as CE\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"requestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&ids={{AE_id}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"works-estimate",
						"v1",
						"abstractestimates",
						"_search"
					],
					"query": [
						{
							"key": "tenantId",
							"value": "{{tenantId}}",
							"equals": true
						},
						{
							"key": "ids",
							"value": "{{AE_id}}",
							"equals": true
						}
					]
				},
				"description": "@CE login"
			},
			"response": []
		},
		{
			"name": "Logout as CE",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "63dfd7de-b53f-454f-b57c-ce323b0d6982",
						"type": "text/javascript",
						"exec": [
							"tests[\"Status code is 200\"] = responseCode.code === 200;",
							"postman.setNextRequest(\"Login as CE\");"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
				},
				"url": {
					"raw": "{{url}}/user/_logout?access_token={{access_token}}",
					"host": [
						"{{url}}"
					],
					"path": [
						"user",
						"_logout"
					],
					"query": [
						{
							"key": "access_token",
							"value": "{{access_token}}",
							"equals": true
						}
					]
				},
				"description": ""
			},
			"response": []
		}
	]
}